 PASS  lib/parsers/tableView.test.ts
 PASS  lib/parsers/smartParse.test.ts
 FAIL  lib/converters/converters.test.ts
  ΓùÅ HTML Converter ΓÇ║ should create HTML table

    expect(received).toContain(expected) // indexOf

    Expected substring: "<td>John</td>"
    Received string:    "<!DOCTYPE html>
    <html lang=\"en\">
    <head>
        <meta charset=\"UTF-8\">
        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">
        <title>JsonExport - Data View</title>
        <link rel=\"icon\" type=\"image/svg+xml\" href=\"https://jsonexport.com/icon.svg\">
        <style>
            :root {
                --primary: #2563eb;
                --primary-hover: #1d4ed8;
                --bg: #f8fafc;
                --surface: #ffffff;
                --text: #0f172a;
                --text-muted: #64748b;
                --border: #e2e8f0;
            }
            body {
                font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                background: var(--bg);
                color: var(--text);
                margin: 0;
                padding: 20px;
                font-size: 14px;
                line-height: 1.5;
            }
            .container {
                max-width: 100%;
                margin: 0 auto;
                background: var(--surface);
                border-radius: 12px;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
                overflow: hidden;
                display: flex;
                flex-direction: column;
                height: calc(100vh - 40px);
            }
            .header {
                padding: 16px 24px;
                border-bottom: 1px solid var(--border);
                display: flex;
                justify-content: space-between;
                align-items: center;
                background: var(--surface);
                z-index: 10;
            }
            .brand {
                display: flex;
                align-items: center;
                gap: 12px;
                font-weight: 700;
                font-size: 18px;
                color: var(--text);
            }
            .brand svg {
                height: 28px;
                width: auto;
            }
            .meta {
                font-size: 13px;
                color: var(--text-muted);
            }
            .actions {
                display: flex;
                gap: 12px;
            }
            .btn {
                background: var(--primary);
                color: white;
                border: none;
                padding: 8px 16px;
                border-radius: 6px;
                font-weight: 500;
                cursor: pointer;
                transition: background 0.2s;
                font-size: 13px;
                display: flex;
                align-items: center;
                gap: 8px;
            }
            .btn:hover {
                background: var(--primary-hover);
            }
            .table-wrapper {
                flex: 1;
                overflow: auto;
                position: relative;
            }
            table {
                width: 100%;
                border-collapse: collapse;
                white-space: nowrap;
            }
            th {
                background: #f1f5f9;
                color: var(--text);
                font-weight: 600;
                text-align: left;
                padding: 12px 16px;
                position: sticky;
                top: 0;
                z-index: 5;
                border-bottom: 2px solid var(--border);
                font-size: 13px;
                text-transform: uppercase;
                letter-spacing: 0.05em;
            }
            td {
                padding: 10px 16px;
                border-bottom: 1px solid var(--border);
                color: var(--text);
            }
            tr:nth-child(even) {
                background: #f8fafc;
            }
            tr:hover {
                background: #eff6ff;
            }
            .null {
                color: var(--text-muted);
                font-style: italic;
            }┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖
            /* Scrollbar styling */
            ::-webkit-scrollbar {
                width: 8px;
                height: 8px;
            }
            ::-webkit-scrollbar-track {
                background: transparent;
            }
            ::-webkit-scrollbar-thumb {
                background: #cbd5e1;
                border-radius: 4px;
            }
            ::-webkit-scrollbar-thumb:hover {
                background: #94a3b8;
            }┬╖
            @media (max-width: 640px) {
                body { padding: 0; }
                .container { height: 100vh; border-radius: 0; }
                .header { flex-direction: column; align-items: flex-start; gap: 12px; }
                .actions { width: 100%; }
                .btn { flex: 1; justify-content: center; }
            }
        </style>
    </head>
    <body>
        <div class=\"container\">
            <header class=\"header\">
                <div class=\"brand\">
                    <svg viewBox=\"0 0 40 40\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">
                        <rect width=\"40\" height=\"40\" rx=\"8\" fill=\"#2563eb\"/>
                        <path d=\"M12 20L20 12V17H28V23H20V28L12 20Z\" fill=\"white\"/>
                        <path d=\"M8 8C4 8 4 15 4 15\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-opacity=\"0.4\"/>
                        <path d=\"M32 8C36 8 36 15 36 15\" stroke=\"white\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-opacity=\"0.4\"/>
                    </svg>
                    JsonExport
                </div>
                <div class=\"meta\">
                    2 rows ΓÇó 3 columns ΓÇó 1/21/2026
                </div>
                <div class=\"actions\">
                    <button class=\"btn\" onclick=\"copyTable()\">Copy Data</button>
                </div>
            </header>┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖
            <div class=\"table-wrapper\">
                <table id=\"dataTable\">
                    <thead>
                        <tr>
                            <th>name</th><th>age</th><th>city</th>
                        </tr>
                    </thead>
                    <tbody>┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖
                            <tr>
                                <td class=\"\">John</td><td class=\"\">30</td><td class=\"\">NYC</td>
                            </tr>┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖
                            <tr>
                                <td class=\"\">Jane</td><td class=\"\">25</td><td class=\"\">LA</td>
                            </tr>┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖
                    </tbody>
                </table>
            </div>
        </div>┬╖
        <script>
            function copyTable() {
                const table = document.getElementById('dataTable');
                const range = document.createRange();
                range.selectNode(table);
                window.getSelection().removeAllRanges();
                window.getSelection().addRange(range);
                document.execCommand('copy');
                window.getSelection().removeAllRanges();┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖┬╖
                const btn = document.querySelector('.btn');
                const originalText = btn.innerHTML;
                btn.innerHTML = 'Copied!';
                setTimeout(() => btn.innerHTML = originalText, 2000);
            }
        </script>
    </body>
    </html>"

      72 |         expect(html).toContain('<table');
      73 |         expect(html).toContain('<th>name</th>');
    > 74 |         expect(html).toContain('<td>John</td>');
         |                      ^
      75 |     });
      76 |
      77 |     it('should escape HTML entities', () => {

      at Object.toContain (lib/converters/converters.test.ts:74:22)

 PASS  tests/columnOperations.test.ts
 PASS  tests/performance.test.ts
  ΓùÅ Console

    console.log
      Flatten 1k rows: 6.10ms

      at Object.log (tests/performance.test.ts:45:21)

    console.log
      Flatten 10k rows: 77.02ms

      at Object.log (tests/performance.test.ts:55:21)

    console.log
      Flatten nested 1k items: 60.02ms

      at Object.log (tests/performance.test.ts:65:21)

    console.log
      CSV export 1k rows: 8.78ms

      at Object.log (tests/performance.test.ts:78:21)

    console.log
      CSV export 10k rows: 35.05ms

      at Object.log (tests/performance.test.ts:89:21)

    console.log
      HTML export 1k rows: 50.24ms

      at Object.log (tests/performance.test.ts:102:21)

    console.log
      Table view expand 1k rows: 7.02ms

      at Object.log (tests/performance.test.ts:114:21)

    console.log
      Column filter 1000 iterations: 4.91ms

      at Object.log (tests/performance.test.ts:131:21)

    console.log
      Column reorder 1000 iterations: 0.51ms

      at Object.log (tests/performance.test.ts:150:21)

    console.log
      Flatten 1k rows ├ù 50 cols: 120.74ms

      at Object.log (tests/performance.test.ts:174:17)

 PASS  tests/verification.test.ts
  ΓùÅ Console

    console.log
      
      === 1. Nested View Verification ===

      at log (tests/verification.test.ts:43:13)

    console.log
      Verified by source data inspection.

      at log (tests/verification.test.ts:44:13)

    console.log
      Value at events[0].properties.page: /cart_edited

      at log (tests/verification.test.ts:45:13)

    console.log
      
      === 2. Flat View Verification ===

      at Object.log (tests/verification.test.ts:48:17)

    console.log
      Flat View Row Sample (Keys): [
        'events.0.eventId',
        'events.0.eventType',
        'events.0.properties.device'
      ]

      at Object.log (tests/verification.test.ts:57:17)

    console.log
      Target Value in Flat View: /cart_edited

      at Object.log (tests/verification.test.ts:58:17)

    console.log
      
      === 3. Table View Verification ===

      at Object.log (tests/verification.test.ts:64:17)

    console.log
      Table View Schema: [
        'eventId',
        'eventType',
        'properties.device',
        'properties.page',
        'properties.price',
        'properties.productId',
        'properties.quantity',
        'properties.referrer',
        'timestamp',
        'userId'
      ]

      at Object.log (tests/verification.test.ts:71:17)

    console.log
      Target Value in Table View: /cart_edited

      at Object.log (tests/verification.test.ts:76:17)

    console.log
      
      === 4. CSV Export Verification ===

      at Object.log (tests/verification.test.ts:81:17)

    console.log
      CSV Snippet:
       ∩╗┐events.0.eventId,events.0.eventType,events.0.properties.device,events.0.properties.page,events.0.properties.referrer,events.0.timestamp,events.0.userId,events.1.eventId,events.1.eventType,events.1.pr

      at Object.log (tests/verification.test.ts:85:17)

    console.log
      
      === 5. HTML Export Verification ===

      at Object.log (tests/verification.test.ts:90:17)

    console.log
      HTML Snippet containing value: /cart_edited

      at Object.log (tests/verification.test.ts:94:17)

    console.log
      
      === 6. Excel (Table) Export Verification ===

      at Object.log (tests/verification.test.ts:99:17)

    console.log
      === Excel Table View Export ===

      at log (lib/converters/jsonToXlsxTableView.ts:11:13)

    console.log
      Input data: [
        {
          "eventId": "evt_001",
          "userId": "user_123",
          "eventType": "page_view",
          "timestamp": "2024-01-10T14:30:00Z",
          "properties": {
            "page": "/cart_edited",
            "referrer": "google.com",
            "device": "mobile"
          }
        },
        {
          "eventId": "evt_002",
          "userId": "user_123",
          "eventType": "add_to_cart",
          "timestamp": "2024-01-10T14:32:15Z",
          "properties": {
            "productId": "TSHIRT-001",
            "quantity": 2,
            "price": 29.99
          }
        }
      ]

      at log (lib/converters/jsonToXlsxTableView.ts:12:13)

    console.log
      Column headers: [
        'eventId',
        'eventType',
        'properties.device',
        'properties.page',
        'properties.price',
        'properties.productId',
        'properties.quantity',
        'properties.referrer',
        'timestamp',
        'userId'
      ]

      at log (lib/converters/jsonToXlsxTableView.ts:119:13)

    console.log
      Total rows: 2

      at log (lib/converters/jsonToXlsxTableView.ts:120:13)

    console.log
      Worksheet data sample: [
        [
          'eventId',
          'eventType',
          'properties.device',
          'properties.page',
          'properties.price',
          'properties.productId',
          'properties.quantity',
          'properties.referrer',
          'timestamp',
          'userId'
        ],
        [
          'evt_001',
          'page_view',
          'mobile',
          '/cart_edited',
          null,
          null,
          null,
          'google.com',
          '2024-01-10T14:30:00Z',
          'user_123'
        ],
        [
          'evt_002',
          'add_to_cart',
          null,
          null,
          29.99,
          'TSHIRT-001',
          2,
          null,
          '2024-01-10T14:32:15Z',
          'user_123'
        ]
      ]

      at log (lib/converters/jsonToXlsxTableView.ts:135:13)

    console.log
      Excel Config: { sheets: [ 'Data' ] }

      at Object.log (tests/verification.test.ts:110:21)

    console.log
      Excel Data Sample: [{"eventId":"evt_001","eventType":"page_view","properties.device":"mobile","properties.page":"/cart_edited","properties.referrer":"google.com","timestamp":"2024-01-10T14:30:00Z","userId":"user_123"}]

      at Object.log (tests/verification.test.ts:111:21)

 PASS  lib/parsers/flattener.test.ts
 PASS  lib/parsers/unwrapper.test.ts
 FAIL  scripts/performance-test.spec.ts
  ΓùÅ Test suite failed to run

    ReferenceError: TransformStream is not defined

       9 | import { test, expect, Page } from '@playwright/test';
      10 | import * as fs from 'fs';
    > 11 | import * as path from 'path';
         |               ^
      12 |
      13 | const TEST_DATA_DIR = path.join(__dirname, '..', 'test-data');
      14 | const BASE_URL = 'http://localhost:3000';

      at Object.<anonymous> (node_modules/playwright/lib/mcpBundleImpl.js:17:5390)
      at Object.<anonymous> (node_modules/playwright/lib/mcp/sdk/bundle.js:48:22)
      at Object.<anonymous> (node_modules/playwright/lib/mcp/sdk/server.js:40:25)
      at Object.<anonymous> (node_modules/playwright/lib/mcp/browser/config.js:50:21)
      at Object.<anonymous> (node_modules/playwright/lib/mcp/test/browserBackend.js:24:21)
      at Object.<anonymous> (node_modules/playwright/lib/index.js:45:29)
      at Object.<anonymous> (node_modules/playwright/test.js:17:13)
      at Object.<anonymous> (node_modules/@playwright/test/index.js:17:18)
      at Object.<anonymous> (scripts/performance-test.spec.ts:11:15)

Test Suites: 2 failed, 7 passed, 9 total
Tests:       1 failed, 101 passed, 102 total
Snapshots:   0 total
Time:        5.519 s
Ran all test suites.
